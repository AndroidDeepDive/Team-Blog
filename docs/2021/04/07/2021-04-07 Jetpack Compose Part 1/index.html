<!doctype html>
<html lang="ko"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="theme-color" content="#71D88D"><title>Jetpack Compose Part 1 - Compose 소개 및 코드랩 따라하기 - Android Deep Dive</title><link rel="manifest" href="/Team-Blog/manifest.json"><meta name="application-name" content="Android Deep Dive"><meta name="msapplication-TileImage" content="/img/favicon.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Android Deep Dive"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Author in AndroidDeepDive Study  김남훈 @Naver 배희성 @RocketPunch 송시영 @SmartStudy 이기정 @BankSalad  Jetpack Compose란 무엇인가?   출처 Android Developers#Jetpack Compse  Compose는 Native UI를 코드레벨로 구현할 수 있는 최신 툴킷이다"><meta property="og:type" content="blog"><meta property="og:title" content="Jetpack Compose Part 1 - Compose 소개 및 코드랩 따라하기"><meta property="og:url" content="https://androiddeepdive.github.io/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/"><meta property="og:site_name" content="Android Deep Dive"><meta property="og:description" content="Author in AndroidDeepDive Study  김남훈 @Naver 배희성 @RocketPunch 송시영 @SmartStudy 이기정 @BankSalad  Jetpack Compose란 무엇인가?   출처 Android Developers#Jetpack Compse  Compose는 Native UI를 코드레벨로 구현할 수 있는 최신 툴킷이다"><meta property="og:locale" content="ko_KR"><meta property="og:image" content="https://androiddeepdive.github.io/Team-Blog/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/compose_animation.gif"><meta property="og:image" content="https://cdn-images-1.medium.com/max/3592/1*5gfrQWfxyEC7Oq6b2xlJ9w.png"><meta property="og:image" content="https://imgur.com/aO6Jlsg.jpg"><meta property="og:image" content="https://imgur.com/WprDTs1.jpg"><meta property="og:image" content="https://imgur.com/qgQ6oY4.jpg"><meta property="og:image" content="https://imgur.com/VLTxB8C.jpg"><meta property="og:image" content="https://imgur.com/Ju6BSg2.gif"><meta property="article:published_time" content="2021-04-06T16:00:00.000Z"><meta property="article:modified_time" content="2021-07-25T05:23:38.903Z"><meta property="article:author" content="Android Deep Dive"><meta property="article:tag" content="Android"><meta property="article:tag" content="Jetpack"><meta property="article:tag" content="Compose"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/Team-Blog/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/compose_animation.gif"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://androiddeepdive.github.io/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/"},"headline":"Jetpack Compose Part 1 - Compose 소개 및 코드랩 따라하기","image":["https://androiddeepdive.github.io/Team-Blog/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/compose_animation.gif","https://cdn-images-1.medium.com/max/3592/1*5gfrQWfxyEC7Oq6b2xlJ9w.png","https://imgur.com/aO6Jlsg.jpg","https://imgur.com/WprDTs1.jpg","https://imgur.com/qgQ6oY4.jpg","https://imgur.com/VLTxB8C.jpg","https://imgur.com/Ju6BSg2.gif"],"datePublished":"2021-04-06T16:00:00.000Z","dateModified":"2021-07-25T05:23:38.903Z","author":{"@type":"Person","name":"Android Deep Dive"},"publisher":{"@type":"Organization","name":"Android Deep Dive","logo":{"@type":"ImageObject","url":"https://androiddeepdive.github.io/img/logo.png"}},"description":"Author in AndroidDeepDive Study  김남훈 @Naver 배희성 @RocketPunch 송시영 @SmartStudy 이기정 @BankSalad  Jetpack Compose란 무엇인가?   출처 Android Developers#Jetpack Compse  Compose는 Native UI를 코드레벨로 구현할 수 있는 최신 툴킷이다"}</script><link rel="canonical" href="https://androiddeepdive.github.io/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/"><link rel="icon" href="/Team-Blog/img/favicon.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/Team-Blog/css/default.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/Team-Blog/"><img src="/Team-Blog/img/logo.png" alt="Android Deep Dive" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/Team-Blog/">홈</a><a class="navbar-item" href="/Team-Blog/archives">아카이브</a><a class="navbar-item" href="/Team-Blog/categories">카테고리</a><a class="navbar-item" href="/Team-Blog/tags">태그</a><a class="navbar-item" href="/Team-Blog/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Repository of Study" href="https://github.com/AndroidDeepDive"><i class="fab fa-github"></i></a><a class="navbar-item search" title="검색" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-04-06T16:00:00.000Z" title="2021. 4. 7. 오전 1:00:00">2021-04-07</time>&nbsp;게시 됨</span><span class="level-item"><time dateTime="2021-07-25T05:23:38.903Z" title="2021. 7. 25. 오후 2:23:38">2021-07-25</time>&nbsp;업데이트 됨</span><span class="level-item"><a class="link-muted" href="/Team-Blog/categories/Jetpack-Compose/">Jetpack Compose</a></span></div></div><h1 class="title is-3 is-size-4-mobile">Jetpack Compose Part 1 - Compose 소개 및 코드랩 따라하기</h1><div class="content"><span id="more"></span>

<p><strong>Author in <a target="_blank" rel="noopener" href="https://github.com/AndroidDeepDive/Study">AndroidDeepDive Study</a></strong></p>
<ul>
<li>김남훈 @Naver</li>
<li>배희성 @RocketPunch</li>
<li>송시영 @SmartStudy</li>
<li>이기정 @BankSalad</li>
</ul>
<h2 id="Jetpack-Compose란-무엇인가"><a href="#Jetpack-Compose란-무엇인가" class="headerlink" title="Jetpack Compose란 무엇인가?"></a>Jetpack Compose란 무엇인가?</h2><img src="/Team-Blog/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/compose_animation.gif" class="" title="[compose_animation]">

<blockquote>
<p><strong>출처</strong> <a target="_blank" rel="noopener" href="https://developer.android.com/jetpack/compose">Android Developers#Jetpack Compse</a></p>
</blockquote>
<p>Compose는 Native UI를 코드레벨로 구현할 수 있는 최신 툴킷이다. </p>
<p>기존의 뷰를 업데이트하는 방식과 달리 Compose를 사용하면 필요한 영역의 뷰를 다시 그려주는 방식으로 작업할 수 있다.</p>
<p>아래는 아주 간단한 예제이다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Greeting</span><span class="params">(name: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">	Text(<span class="string">&quot;Hello <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위의 예제처럼 UI를 구성하는 것이 아니라 화면을 구성하는 뷰의 State 설명하는 것이므로 아무것도 반환하지 않는다.</p>
<p>아래는 공식 서비스 소개 영상이다.</p>
<div style="width: 560px; height: 315px; float: none; clear: both;">
  <embed
    src="https://www.youtube.com/embed/U5BwfqBpiWU"
    wmode="transparent"
    type="video/mp4"
    width="100%" height="100%"
    allow="autoplay; encrypted-media; picture-in-picture"
    allowfullscreen
  >
</div>

<h3 id="Compose의-4가지-특징"><a href="#Compose의-4가지-특징" class="headerlink" title="Compose의 4가지 특징"></a>Compose의 4가지 특징</h3><p>구글에서 설명하는 Compose를 이용시 얻을 수 있는 장점은 아래와 같다.</p>
<ul>
<li><code>Less Code</code> - 코드 감소<ul>
<li>적은 수의 코드로 더 많은 작업을 하고 전체 버그 클래스를 방지할 수 있으므로 코드가 간단하며 유지 관리하기 쉽습니다.</li>
</ul>
</li>
<li><code>Intuitive</code> - 직관적<ul>
<li>UI만 설명하면 나머지는 Compose에서 처리합니다. 앱 상태가 변경되면 UI가 자동으로 업데이트됩니다.</li>
</ul>
</li>
<li><code>Accelerate Development</code> - 빠른 개발 과정<ul>
<li>기존의 모든 코드와 호환되므로 언제 어디서든 원하는 대로 사용할 수 있습니다. 실시간 미리보기 및 완전한 Android 스튜디오 지원으로 빠르게 반복할 수 있습니다.</li>
</ul>
</li>
<li><code>Powerful</code> - 강력한 성능<ul>
<li>Android 플랫폼 API에 직접 액세스하고 머티리얼 디자인, 어두운 테마, 애니메이션 등을 기본적으로 지원하는 멋진 앱을 만들 수 있습니다.</li>
</ul>
</li>
</ul>
<p>늘 그렇듯 구글에서 말하는 설명만 보면 안 쓸 이유가 없어보이고, 대세가 된다면 Android 개발자에게 또 하나의 러닝커브로 작용할 것이다.</p>
<h2 id="Codelab-Jetpack-Compose-basics"><a href="#Codelab-Jetpack-Compose-basics" class="headerlink" title="Codelab - Jetpack Compose basics"></a>Codelab - Jetpack Compose basics</h2><h3 id="1-시작하기전에"><a href="#1-시작하기전에" class="headerlink" title="1. 시작하기전에"></a>1. 시작하기전에</h3><p>Compose는 아직 정식으로 릴리즈되지 않은 기능이므로 Android Studio Canary에서 프로젝트를 구성하며 몇 가지 제한사항이 존재한다.</p>
<ol>
<li>Android Studio Canary </li>
</ol>
<p>Canary는 아래 링크에서 다운 받을 수 있다.</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.android.com/studio/preview">Android Studio Preview</a></p>
</blockquote>
<ol start="2">
<li>최신 버전의 Kotlin plugin </li>
</ol>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ext.kotlin_version = <span class="string">&#x27;1.4.31&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>buildFeatures 및 composeOption 활성화</li>
</ol>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    buildFeatures &#123;</span><br><span class="line">        compose <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    composeOptions &#123;</span><br><span class="line">        kotlinCompilerExtensionVersion <span class="number">1.0</span><span class="number">.0</span>-beta02</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    ...</span><br><span class="line">    implementation <span class="string">&quot;androidx.compose.ui:ui:1.0.0-beta02&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.activity:activity-compose:1.3.0-alpha03&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.compose.material:material:1.0.0-beta02&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.compose.ui:ui-tooling:1.0.0-beta02&quot;</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-Empty-Compose-프로젝트-생성"><a href="#2-Empty-Compose-프로젝트-생성" class="headerlink" title="2. Empty Compose 프로젝트 생성"></a>2. Empty Compose 프로젝트 생성</h3><p>[File] - [New] - [New Project…] 를 눌러 새로운 프로젝트를 선택하고(Preview) Empty Compose Activity 를 선택한다.</p>
<p><img src="https://cdn-images-1.medium.com/max/3592/1*5gfrQWfxyEC7Oq6b2xlJ9w.png"></p>
<p>선택 이후 Next를 클릭하고, Compose를 구현할 수 있는 최소 API 레벨인 21을 선택해야한다.</p>
<p>프로젝트를 생성하면 아래와 같이 app/build.gradle에 의존성 설정 및 추가가 되어 있는것을 알 수 있다.</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    kotlinOptions &#123;</span><br><span class="line">        jvmTarget = <span class="string">&#x27;1.8&#x27;</span></span><br><span class="line">        useIR = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    buildFeatures &#123;</span><br><span class="line">        compose <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    composeOptions &#123;</span><br><span class="line">        kotlinCompilerExtensionVersion compose_version</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    ...</span><br><span class="line">    implementation <span class="string">&quot;androidx.compose.ui:ui:$compose_version&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.activity:activity-compose:1.3.0-alpha03&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.compose.material:material:$compose_version&quot;</span></span><br><span class="line">    implementation <span class="string">&quot;androidx.compose.ui:ui-tooling:$compose_version&quot;</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이때 composeOptions 설정에서 kotlinCompilerVersion 에 따라 compose 가 다르게 동작할 수 있음을 유의하자.</p>
<p>프로젝트를 생성하면 아래와 같은 기본 파일들이 생성된다.</p>
<p><strong>MainActivity.kt</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContent &#123;</span><br><span class="line">            MyFirstComposeApplicationTheme &#123;</span><br><span class="line">                <span class="comment">// A surface container using the &#x27;background&#x27; color from the theme</span></span><br><span class="line">                Surface(color = MaterialTheme.colors.background) &#123;</span><br><span class="line">                    Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Greeting</span><span class="params">(name: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">    Text(text = <span class="string">&quot;Hello <span class="variable">$name</span>!&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Preview(showBackground = true)</span></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">DefaultPreview</span><span class="params">()</span></span> &#123;</span><br><span class="line">    MyFirstComposeApplicationTheme &#123;</span><br><span class="line">        Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ui/theme/Theme.kt</strong></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> DarkColorPalette = darkColors(</span><br><span class="line">    primary = Purple200,</span><br><span class="line">    primaryVariant = Purple700,</span><br><span class="line">    secondary = Teal200</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> LightColorPalette = lightColors(</span><br><span class="line">    primary = Purple500,</span><br><span class="line">    primaryVariant = Purple700,</span><br><span class="line">    secondary = Teal200*</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Other default colors to override</span></span><br><span class="line"><span class="comment">    background = Color.White,</span></span><br><span class="line"><span class="comment">    surface = Color.White,</span></span><br><span class="line"><span class="comment">    onPrimary = Color.White,</span></span><br><span class="line"><span class="comment">    onSecondary = Color.Black,</span></span><br><span class="line"><span class="comment">    onBackground = Color.Black,</span></span><br><span class="line"><span class="comment">    onSurface = Color.Black,</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyFirstComposeApplicationTheme</span><span class="params">(darkTheme: <span class="type">Boolean</span> = isSystemInDarkTheme()</span></span>, content: <span class="meta">@Composable</span> () -&gt; <span class="built_in">Unit</span>) &#123;</span><br><span class="line">    <span class="keyword">val</span> colors = <span class="keyword">if</span> (darkTheme) &#123;</span><br><span class="line">        DarkColorPalette*</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        LightColorPalette*</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    MaterialTheme(</span><br><span class="line">        colors = colors,</span><br><span class="line">        typography = Typography,</span><br><span class="line">        shapes = Shapes,</span><br><span class="line">        content = content</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>기본 생성된 코드를 보았을 때, Compose는 총 3가지의 구성 요소를 가지는 것으로 추측할 수 있다.</p>
<ol>
<li>위젯을 포함하는 Composable 함수</li>
<li>Preview를 하기 위한 Preview Composable 함수</li>
<li>setContent 람다 표현식으로 실제 화면에 노출하는 코드</li>
</ol>
<p>일반적으로 우리가 아는 Activity의 라이프사이클 콜백 <code>onCreate()</code>에서   <code>setContentView(Int)</code> 함수를 호출하던것이 <code>setContent()</code> 함수로 바뀐것이 가장 큰 특징으로 보여진다.</p>
<h3 id="3-Composable-Function"><a href="#3-Composable-Function" class="headerlink" title="3. Composable Function"></a>3. Composable Function</h3><p>Composable Function은 어노테이션을 이용한 기술이다. 함수위에 <code>@Composable</code> 어노테이션을 붙이게 되면 함수 안 다른 함수를 호출할 수 있게된다. 아래 코드를 보자.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Greeting</span><span class="params">(names: <span class="type">List</span>&lt;<span class="type">String</span>&gt;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (name <span class="keyword">in</span> names) &#123;</span><br><span class="line">        Text(<span class="string">&quot;Hello <span class="variable">$name</span>&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>단순하게 내부에는 Text라는 함수가 존재하는데, 이를 통해 UI계층 별 요구하는 컴포넌트를 생성해준다. 기본적으로 보이는 text 파라미터는 내부 속성에서 받는 일부 중 하나이다.</p>
<h3 id="4-TextView-만들기"><a href="#4-TextView-만들기" class="headerlink" title="4. TextView 만들기"></a>4. TextView 만들기</h3><p>위 코드를 실행시켜보면 당연하게도 Hello로 시작하는 TextView가 화면에 그려질것을 암시한다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">setContent &#123;</span><br><span class="line">  BasicsCodelabTheme &#123;</span><br><span class="line">    <span class="comment">// A surface container using the &#x27;background&#x27; color from the theme</span></span><br><span class="line">    Surface(color = MaterialTheme.colors.background) &#123;</span><br><span class="line">      Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://imgur.com/aO6Jlsg.jpg" alt="output"></p>
<h3 id="5-Preview"><a href="#5-Preview" class="headerlink" title="5. @Preview"></a>5. <code>@Preview</code></h3><p>말 그대로 어노테이션을 이용하여 IDE에서 Preview를하기 위한 용도이다. 아래 코드와 같이 @Preview 어노테이션을 추가하면 다음 결과를 볼 수 있다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Preview(<span class="meta-string">&quot;Greeting Preview&quot;</span>)</span></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">GreetingPreview</span><span class="params">()</span></span> &#123;</span><br><span class="line">    BasicsCodelabTheme &#123;</span><br><span class="line">        Surface(color = MaterialTheme.colors.background) &#123;</span><br><span class="line">            Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://imgur.com/WprDTs1.jpg" alt="Greeting Preview"></p>
<h3 id="6-setContent-Theme-Surface"><a href="#6-setContent-Theme-Surface" class="headerlink" title="6. setContent / Theme / Surface"></a>6. setContent / Theme / Surface</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">setContent &#123;</span><br><span class="line">  BasicsCodelabTheme &#123;</span><br><span class="line">    <span class="comment">// A surface container using the &#x27;background&#x27; color from the theme</span></span><br><span class="line">    Surface(color = MaterialTheme.colors.background) &#123;</span><br><span class="line">      Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>기존에 onCreate시점에 화면을 그려주기 위한 필수적인 요소를 정리해보자면</p>
<ul>
<li><p><strong>setContent</strong> : Activity에서 setContentView함수를 사용하는 것과 동일한 동작을 하는 확장함수이다. 다만, setContent의 경우 (@Composable) -&gt; Unit 타입의 컴포즈 UI를 구현해주어야한다.</p>
</li>
<li><p><strong>XXXTheme</strong> : Theme정보를 의미한다. 해당 프로젝트에서는 Theme.kt에 여러 테마에 필요한 정보를 정리하고, 컴포즈 UI 구현을 위한 코드를 작성해두었다.</p>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> DarkColorPalette = darkColors(</span><br><span class="line">    primary = purple200,</span><br><span class="line">    primaryVariant = purple700,</span><br><span class="line">    secondary = teal200</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> LightColorPalette = lightColors(</span><br><span class="line">    primary = purple500,</span><br><span class="line">    primaryVariant = purple700,</span><br><span class="line">    secondary = teal200</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Other default colors to override</span></span><br><span class="line"><span class="comment">    background = Color.White,</span></span><br><span class="line"><span class="comment">    surface = Color.White,</span></span><br><span class="line"><span class="comment">    onPrimary = Color.White,</span></span><br><span class="line"><span class="comment">    onSecondary = Color.Black,</span></span><br><span class="line"><span class="comment">    onBackground = Color.Black,</span></span><br><span class="line"><span class="comment">    onSurface = Color.Black,</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">BasicsCodelabTheme</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    darkTheme: <span class="type">Boolean</span> = isSystemInDarkTheme()</span></span>,</span><br><span class="line">    content: <span class="meta">@Composable</span> () -&gt; <span class="built_in">Unit</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">val</span> colors = <span class="keyword">if</span> (darkTheme) &#123;</span><br><span class="line">        DarkColorPalette</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        LightColorPalette</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    MaterialTheme(</span><br><span class="line">        colors = colors,</span><br><span class="line">        typography = typography,</span><br><span class="line">        shapes = shapes,</span><br><span class="line">        content = content</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>Surface</strong> : Greeting을 감싸는 뷰에 해당한다. 여기서는 크기를 정하지 않고, background 색상을 정의하고 있다. 역시 람다 표현식이다. 색상에 대한 Paramter로 <code>color</code> 라는 값을 사용하여 부여가 가능하다. 내부코드를 보면</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Surface</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    modifier: <span class="type">Modifier</span> = Modifier,</span></span></span><br><span class="line"><span class="params"><span class="function">    shape: <span class="type">Shape</span> = RectangleShape,</span></span></span><br><span class="line"><span class="params"><span class="function">    color: <span class="type">Color</span> = MaterialTheme.colors.surface,</span></span></span><br><span class="line"><span class="params"><span class="function">    contentColor: <span class="type">Color</span> = contentColorFor(color)</span></span>,</span><br><span class="line">    border: BorderStroke? = <span class="literal">null</span>,</span><br><span class="line">    elevation: Dp = <span class="number">0.</span>dp,</span><br><span class="line">    content: <span class="meta">@Composable</span> () -&gt; <span class="built_in">Unit</span></span><br><span class="line">) &#123;</span><br><span class="line">    <span class="keyword">val</span> elevationPx = with(LocalDensity.current) &#123; elevation.toPx() &#125;</span><br><span class="line">    <span class="keyword">val</span> elevationOverlay = LocalElevationOverlay.current</span><br><span class="line">    <span class="keyword">val</span> absoluteElevation = LocalAbsoluteElevation.current + elevation</span><br><span class="line">    <span class="keyword">val</span> backgroundColor = <span class="keyword">if</span> (color == MaterialTheme.colors.surface &amp;&amp; elevationOverlay != <span class="literal">null</span>) &#123;</span><br><span class="line">        elevationOverlay.apply(color, absoluteElevation)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        color</span><br><span class="line">    &#125;</span><br><span class="line">    CompositionLocalProvider(</span><br><span class="line">        LocalContentColor provides contentColor,</span><br><span class="line">        LocalAbsoluteElevation provides absoluteElevation</span><br><span class="line">    ) &#123;</span><br><span class="line">        Box(</span><br><span class="line">            modifier.graphicsLayer(shadowElevation = elevationPx, shape = shape)</span><br><span class="line">                .then(<span class="keyword">if</span> (border != <span class="literal">null</span>) Modifier.border(border, shape) <span class="keyword">else</span> Modifier)</span><br><span class="line">                .background(</span><br><span class="line">                    color = backgroundColor,</span><br><span class="line">                    shape = shape</span><br><span class="line">                )</span><br><span class="line">                .clip(shape),</span><br><span class="line">            propagateMinConstraints = <span class="literal">true</span></span><br><span class="line">        ) &#123;</span><br><span class="line">            content()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-Declarative-UI-선언형-UI"><a href="#7-Declarative-UI-선언형-UI" class="headerlink" title="7. Declarative UI - 선언형 UI"></a>7. Declarative UI - 선언형 UI</h3><p>노란색 배경을 입혀 기존 TextView에 추가해보았다. 또한, Greeting에는 Modifier라는 것을 이용하여 Padding을 추가했다. 아래와 같은 결과가 나오게 되었다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">BasicsCodelabTheme &#123;</span><br><span class="line">  <span class="comment">// A surface container using the &#x27;background&#x27; color from the theme</span></span><br><span class="line">  Surface(color = Color.Yellow) &#123;</span><br><span class="line">    Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Greeting</span><span class="params">(name: <span class="type">String</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> isSelected <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="literal">false</span>) &#125;</span><br><span class="line">    <span class="keyword">val</span> backgroundColor <span class="keyword">by</span> animateColorAsState(<span class="keyword">if</span> (isSelected) Color.Red <span class="keyword">else</span> Color.Transparent)</span><br><span class="line"></span><br><span class="line">    Text(</span><br><span class="line">        text = <span class="string">&quot;Hello <span class="variable">$name</span>!&quot;</span>,</span><br><span class="line">        modifier = Modifier</span><br><span class="line">            .padding(<span class="number">24.</span>dp)</span><br><span class="line">            .background(color = backgroundColor)</span><br><span class="line">            .clickable(onClick = &#123; isSelected = !isSelected &#125;)</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://imgur.com/qgQ6oY4.jpg" alt="결과"></p>
<p>선언형 UI의 장점은 말 그대로 내가 UI를 정의한대로 시각적으로 표현이 가능하다는 장점이 있다. 기존에는 속성을 매번 On/Off와 같은 옵션을 통해 변경하는 것이 다반사였지만, 이제는 매번 속성에 변경이 생길때마다 새로 그려주게 되는것이다.</p>
<h3 id="8-재사용"><a href="#8-재사용" class="headerlink" title="8. 재사용"></a>8. 재사용</h3><p>Compose의 장점 중 하나는 재사용성이 뛰어난것인데, XML에서 우리가 include 태그를 통해 여러곳에서 갖다쓸 수 있던것처럼, 함수를 통해 여러곳에서 정의하여 사용이 가능하다.</p>
<p>참고해야할 점은 Compose 컴포넌트 확장 시 <code>@Composable</code> 어노테이션을 붙여야 한다.</p>
<h3 id="9-Container-작성"><a href="#9-Container-작성" class="headerlink" title="9. Container 작성"></a>9. Container 작성</h3><p>MyApp이라는 이름으로 컴포즈 컴포넌트를 구횬하여 여러곳에서 공통으로 사용할 수 있는 Composable을 구현하였다. 내부적으로 Container내 내가 원하는 컴포넌트를 넣어주려면 아래와 같이 인자로 <code>@Composable () -&gt; Unit</code> 타입을 넘겨받아 처리해주면 된다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyApp</span><span class="params">(content: @<span class="type">Composable</span> () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    BasicsCodelabTheme &#123;</span><br><span class="line">        Surface(color = Color.Yellow) &#123;</span><br><span class="line">            content()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위 함수를 통해 이제는 어디서든 반복해서 사용할 수 있는 Container를 구현하게 되어 아래와 같이 코드를 활용할 수 있게되었다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>() &#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">    setContent &#123;</span><br><span class="line">      MyApp &#123;</span><br><span class="line">        Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-레이아웃을-활용한-Compose-function의-다중-호출"><a href="#10-레이아웃을-활용한-Compose-function의-다중-호출" class="headerlink" title="10. 레이아웃을 활용한 Compose function의 다중 호출"></a>10. 레이아웃을 활용한 Compose function의 다중 호출</h3><p>지금까지는 하나의 컴포넌트만을 갖고 사용했지만, 여러개의 컴포넌트를 넣는것도 가능하다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyScreenContent</span><span class="params">()</span></span> &#123;</span><br><span class="line">    Column &#123;</span><br><span class="line">        Greeting(<span class="string">&quot;Android&quot;</span>)</span><br><span class="line">        Divider(color = Color.Black)</span><br><span class="line">        Greeting(<span class="string">&quot;there&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <code>Column</code>과 위에서부터 사용하던 <code>Greeting</code> 함수를 사용하고, 라인을 그어주기 위한 <code>Divider</code>를 추가한 결과물은 다음과 같다.</p>
<p><img src="https://imgur.com/VLTxB8C.jpg" alt="multiple component"></p>
<p>위 컴포넌트 중 못보던 컴포저블이 있는데, 아래와 같이 설명이 가능하다.</p>
<ul>
<li>Column : 항목을 순서대로 배치하기 위해 사용한다.</li>
<li>Divider : 선 긋기 가능한 Compose 함수이다.</li>
</ul>
<p>이를 리스트 형태로도 구현이 가능하다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyColumnScreen</span><span class="params">(names: <span class="type">List</span>&lt;<span class="type">String</span>&gt; = listOf(<span class="string">&quot;Line One&quot;</span>, <span class="string">&quot;Line Two&quot;</span>)</span></span>) &#123;</span><br><span class="line">    Column &#123;</span><br><span class="line">        names.forEach &#123;</span><br><span class="line">            Greeting(name = it)</span><br><span class="line">            Divider(color = Color.Black)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-State-in-Compose-Compose에서의-상태값-관리"><a href="#11-State-in-Compose-Compose에서의-상태값-관리" class="headerlink" title="11. State in Compose - Compose에서의 상태값 관리"></a>11. State in Compose - Compose에서의 상태값 관리</h3><p>컴포넌트에 버튼을 클릭했을 때 클릭한 카운트를 집계하는 간단한 컴포넌트를 만들어보았다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">MyColumnScreen</span><span class="params">(names: <span class="type">List</span>&lt;<span class="type">String</span>&gt; = listOf(<span class="string">&quot;Line One&quot;</span>, <span class="string">&quot;Line Two&quot;</span>)</span></span>) &#123;</span><br><span class="line">    <span class="keyword">val</span> counterState = remember &#123; mutableStateOf(<span class="number">0</span>) &#125; <span class="comment">// </span></span><br><span class="line"></span><br><span class="line">    Column &#123;</span><br><span class="line">        names.forEach &#123;</span><br><span class="line">            Greeting(name = it)</span><br><span class="line">            Divider(color = Color.Black)</span><br><span class="line">        &#125;</span><br><span class="line">        Counter(</span><br><span class="line">            count = counterState.value,</span><br><span class="line">            updateCount = &#123; newCount -&gt;</span><br><span class="line">                counterState.value = newCount</span><br><span class="line">            &#125;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>remember라는 함수를 사용하여 기존에 존재하는 컴포넌트의 상태값을 기억하게 하는 함수가 있다. </p>
<p><code>remember</code> 함수의 내부를 살펴보자.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Remember the value produced by [calculation]. [calculation] will only be evaluated during the composition.</span></span><br><span class="line"><span class="comment"> * Recomposition will always return the value produced by composition.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@OptIn(ComposeCompilerApi::class)</span></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="keyword">inline</span> <span class="function"><span class="keyword">fun</span> <span class="type">&lt;T&gt;</span> <span class="title">remember</span><span class="params">(calculation: @<span class="type">DisallowComposableCalls</span> () -&gt; <span class="type">T</span>)</span></span>: T =</span><br><span class="line">    currentComposer.cache(<span class="literal">false</span>, calculation)</span><br></pre></td></tr></table></figure>

<p>매 호출마다 Recomposition(재조합)하게되는 경우 컴포넌트에 값을 다시 제공하는 것을 알 수 있다. @Composable 어노테이션에 들어간 함수는 매번 해당 상태를 구독하고, 상태가 변경될때마다 알림을 받아 기존 화면을 갱신해준다.</p>
<p>그리고, 아래 Counter를 보면 Button을 이용하여 이벤트를 받아 처리하도록 했다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Counter</span><span class="params">(count: <span class="type">Int</span>, updateCount: (<span class="type">Int</span>) -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">    Button(</span><br><span class="line">        onClick = &#123; updateCount(count + <span class="number">1</span>) &#125;,</span><br><span class="line">        colors = ButtonDefaults.buttonColors(</span><br><span class="line">            backgroundColor = <span class="keyword">if</span> (count &gt; <span class="number">5</span>) Color.Green <span class="keyword">else</span> Color.White</span><br><span class="line">        )</span><br><span class="line">    ) &#123;</span><br><span class="line">        Text(<span class="string">&quot;I&#x27;ve been clicked <span class="variable">$count</span> times&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>updateCount(Int)</code> 함수릉 통해 매번 값을 업데이트 해주는데, 이를 통해 counterState에 값을 넣어주면서 해당 컴포넌트가 매번 변경이 되는것이다.</p>
<p>따라서 결과를 보면, 다음과 같다. Count가 5가 넘어가면 초록색으로 바뀐다.</p>
<p><img src="https://imgur.com/Ju6BSg2.gif" alt="count"></p>
<p>그 외에도 여러형태의 모양을 구성할수 있도록 옵션이 제공되어 있다. 자세한 정보는 나중에 <a target="_blank" rel="noopener" href="https://developer.android.com/codelabs/jetpack-compose-basics">Codelabs</a>에 더 나와 있으니 보도록하고, 이번에 setContent에 대한 동작원리를 함께 고민해보자.</p>
<h3 id="12-Activity에서의-View-생성-방식과의-비교"><a href="#12-Activity에서의-View-생성-방식과의-비교" class="headerlink" title="12. Activity에서의 View 생성 방식과의 비교"></a>12. Activity에서의 View 생성 방식과의 비교</h3><p>Compose를 안드로이드 앱에서 사용하려면 Activity, Fragment와 같은곳에서 contentView로 뿌려줘야한다. 기존에 우리가 사용하던 함수를 보자.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Set the activity content from a layout resource.  The resource will be</span></span><br><span class="line"><span class="comment">* inflated, adding all top-level views to the activity.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@param</span> layoutResID Resource ID to be inflated.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* <span class="doctag">@see</span> #setContentView(android.view.View)</span></span><br><span class="line"><span class="comment">* <span class="doctag">@see</span> #setContentView(android.view.View, android.view.ViewGroup.LayoutParams)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContentView</span><span class="params">(<span class="meta">@LayoutRes</span> <span class="keyword">int</span> layoutResID)</span> </span>&#123;</span><br><span class="line">  getWindow().setContentView(layoutResID);</span><br><span class="line">  initWindowDecorActionBar();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UI 컴포넌트에서 화면을 붙일 수 있는 Window라는 녀석에서 Layout Resource Id를 통해 기존에 등록되어있던 Layout XML 파일을 로드하여 인플레이터에서 파싱하고, 이를통해 레이아웃 계층에 있는 뷰객체를 생성하여 순차적으로 ViewGroup, View를 만들어 넣어주게 된다.</p>
<p><code>PhoneWindow</code>를 보면 자세하게 알 수 있는데, Window를 구현한 setContentView에서 처음에 생성되는 최상위 레이아웃 그 위에 따로 없다면 <code>installDecor()</code> 함수를 통해 mContentParent(레이아웃 리소스가 붙게될 ViewGroup)를 생성하고, 하위에 넣어주게 된다.</p>
<p>그러면 기존 방식은 이정도로 설명을하고, 이번엔 Compose에서 <code>setContent()</code> 라는 함수를 어떻게 사용하는지 보자.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Composes the given composable into the given activity. The [content] will become the root view</span></span><br><span class="line"><span class="comment"> * of the given activity.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This is roughly equivalent to calling [ComponentActivity.setContentView] with a [ComposeView]</span></span><br><span class="line"><span class="comment"> * i.e.:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ```</span></span><br><span class="line"><span class="comment"> * setContentView(</span></span><br><span class="line"><span class="comment"> *   ComposeView(this).apply &#123;</span></span><br><span class="line"><span class="comment"> *     setContent &#123;</span></span><br><span class="line"><span class="comment"> *       MyComposableContent()</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * )</span></span><br><span class="line"><span class="comment"> * ```</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parent The parent composition reference to coordinate scheduling of composition updates</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content A `<span class="doctag">@Composable</span>` function declaring the UI contents</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> ComponentActivity.<span class="title">setContent</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    parent: <span class="type">CompositionContext</span>? = <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    content: @<span class="type">Composable</span> () -&gt; <span class="type">Unit</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">    <span class="keyword">val</span> existingComposeView = window.decorView</span><br><span class="line">        .findViewById&lt;ViewGroup&gt;(android.R.id.content)</span><br><span class="line">        .getChildAt(<span class="number">0</span>) <span class="keyword">as</span>? ComposeView</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (existingComposeView != <span class="literal">null</span>) with(existingComposeView) &#123;</span><br><span class="line">        setParentCompositionContext(parent)</span><br><span class="line">        setContent(content)</span><br><span class="line">    &#125; <span class="keyword">else</span> ComposeView(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">        <span class="comment">// Set content and parent **before** setContentView</span></span><br><span class="line">        <span class="comment">// to have ComposeView create the composition on attach</span></span><br><span class="line">        setParentCompositionContext(parent)</span><br><span class="line">        setContent(content)</span><br><span class="line">        <span class="comment">// Set the view tree owners before setting the content view so that the inflation process</span></span><br><span class="line">        <span class="comment">// and attach listeners will see them already present</span></span><br><span class="line">        setOwners()</span><br><span class="line">        setContentView(<span class="keyword">this</span>, DefaultActivityContentLayoutParams)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이녀석도 마찬가지로 <code>window.decorView.findViewById&lt;ViewGroup&gt;(android.R.id.content)</code>  함수를 호출하여 decorView를 가져온다. 만약 compose를 통해 만들어진 최상위 레이아웃이 존재하면, 기존에 inflator에서 ViewGroup, View를 생성해서 넣어주던것 처럼 <code>setContent()</code> =&gt; window가 Activity/Fragment에 붙으면 <code>createComposition()</code>를 호출하여 검증 후 <code>ensureCompsositionCreated()</code> 함수를 호출한다. 현재는 내부적으로 <code>ViewGroup.setContent()</code> 를 사용하고 있는데, 곧 교체 될 예정이라고 한다. 이코드도 보면 기존에 있는 ViewGroup에 확장함수로 구현한 녀석인데, 쉽게 말해 ViewGroup에 하위 View, ViewGroup에 Composable로 구현된 함수로 컴포넌트를 넣어줄 때 AndroidComposeView라는 객체를 꺼내오거나 없다면 새로 생성하여 넣어준다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Composes the given composable into the given view.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The new composition can be logically &quot;linked&quot; to an existing one, by providing a</span></span><br><span class="line"><span class="comment"> * [parent]. This will ensure that invalidations and CompositionLocals will flow through</span></span><br><span class="line"><span class="comment"> * the two compositions as if they were not separate.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Note that this [ViewGroup] should have an unique id for the saved instance state mechanism to</span></span><br><span class="line"><span class="comment"> * be able to save and restore the values used within the composition. See [View.setId].</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parent The [Recomposer] or parent composition reference.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content Composable that will be the content of the view.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">internal</span> <span class="function"><span class="keyword">fun</span> ViewGroup.<span class="title">setContent</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    parent: <span class="type">CompositionContext</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    content: @<span class="type">Composable</span> () -&gt; <span class="type">Unit</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span>: Composition &#123;</span><br><span class="line">    GlobalSnapshotManager.ensureStarted()</span><br><span class="line">    <span class="keyword">val</span> composeView =</span><br><span class="line">        <span class="keyword">if</span> (childCount &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            getChildAt(<span class="number">0</span>) <span class="keyword">as</span>? AndroidComposeView</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            removeAllViews(); <span class="literal">null</span></span><br><span class="line">        &#125; ?: AndroidComposeView(context).also &#123; addView(it.view, DefaultLayoutParams) &#125;</span><br><span class="line">    <span class="keyword">return</span> doSetContent(composeView, parent, content)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>다시 돌아와서, ComposeView의 <code>setContent()</code> 이라는 녀석을 보자.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * A [android.view.View] that can host Jetpack Compose UI content.</span></span><br><span class="line"><span class="comment"> * Use [setContent] to supply the content composable function for the view.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This [android.view.View] requires that the window it is attached to contains a</span></span><br><span class="line"><span class="comment"> * [ViewTreeLifecycleOwner]. This [androidx.lifecycle.LifecycleOwner] is used to</span></span><br><span class="line"><span class="comment"> * [dispose][androidx.compose.runtime.Composition.dispose] of the underlying composition</span></span><br><span class="line"><span class="comment"> * when the host [Lifecycle] is destroyed, permitting the view to be attached and</span></span><br><span class="line"><span class="comment"> * detached repeatedly while preserving the composition. Call [disposeComposition]</span></span><br><span class="line"><span class="comment"> * to dispose of the underlying composition earlier, or if the view is never initially</span></span><br><span class="line"><span class="comment"> * attached to a window. (The requirement to dispose of the composition explicitly</span></span><br><span class="line"><span class="comment"> * in the event that the view is never (re)attached is temporary.)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ComposeView</span> <span class="meta">@JvmOverloads</span> <span class="keyword">constructor</span></span>(</span><br><span class="line">    context: Context,</span><br><span class="line">    attrs: AttributeSet? = <span class="literal">null</span>,</span><br><span class="line">    defStyleAttr: <span class="built_in">Int</span> = <span class="number">0</span></span><br><span class="line">) : AbstractComposeView(context, attrs, defStyleAttr) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">val</span> content = mutableStateOf&lt;(<span class="meta">@Composable</span> () -&gt; <span class="built_in">Unit</span>)?&gt;(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Suppress(<span class="meta-string">&quot;RedundantVisibilityModifier&quot;</span>)</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="keyword">var</span> shouldCreateCompositionOnAttachedToWindow: <span class="built_in">Boolean</span> = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">set</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Composable</span></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">Content</span><span class="params">()</span></span> &#123;</span><br><span class="line">        content.value?.invoke()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Set the Jetpack Compose UI content for this view.</span></span><br><span class="line"><span class="comment">     * Initial composition will occur when the view becomes attached to a window or when</span></span><br><span class="line"><span class="comment">     * [createComposition] is called, whichever comes first.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">setContent</span><span class="params">(content: @<span class="type">Composable</span> () -&gt; <span class="type">Unit</span>)</span></span> &#123;</span><br><span class="line">        shouldCreateCompositionOnAttachedToWindow = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">this</span>.content.value = content</span><br><span class="line">        <span class="keyword">if</span> (isAttachedToWindow) &#123;</span><br><span class="line">            createComposition()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>결론적으로 <code>AbstractComposeView</code> 라는 녀석은 ViewGroup을 상속받은 녀석이며, 모든 composable의 상태가 변화 되었을 때 이를 감지하는 중요한 녀석이다.</p>
<p><code>setContent()</code>라는 함수는 위에서 설명했으니 넘어가고, 이번에는 <code>Content</code>라는 녀석을 보자. 이녀석은 추상 메소드로, <code>createComposition()</code> 이라는 함수가 호출 되었을 때, 가장 먼저 불리는 함수이다. 아까 언급되었던 <code>ensureCompsositionCreated()</code> 함수에서 tree계층의 ComposeView가 다 붙었다면, 이후에 즉시 Content함수가 호출이된다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Suppress(<span class="meta-string">&quot;DEPRECATION&quot;</span>)</span> <span class="comment">// Still using ViewGroup.setContent for now</span></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">ensureCompositionCreated</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (composition == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                creatingComposition = <span class="literal">true</span></span><br><span class="line">                composition = setContent(</span><br><span class="line">                    parentContext ?: findViewTreeCompositionContext() ?: windowRecomposer</span><br><span class="line">                ) &#123;</span><br><span class="line">                    Content() <span class="comment">// 이곳에서 뷰가 다 window에 붙게되면 콜백을 호출한다.</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                creatingComposition = <span class="literal">false</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>그러면 아래 <code>ComposeView</code>의 오버라이딩 된 Content가 호출되면서, 기존에 생성된 View에 UI속성과 같은 Content가 붙게된다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* The Jetpack Compose UI content for this view.</span></span><br><span class="line"><span class="comment">* Subclasses must implement this method to provide content. Initial composition will</span></span><br><span class="line"><span class="comment">* occur when the view becomes attached to a window or when [createComposition] is called,</span></span><br><span class="line"><span class="comment">* whichever comes first.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Composable</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="function"><span class="keyword">fun</span> <span class="title">Content</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure>

<p>Content는 설명에서 보는것과 같이 <code>createComposition()</code> 함수 호출 후 View가 Window에 붙은 이후 즉시 호출된다.</p>
<p>최종적으로 <code>ComponentActivity.setContent(CompositionContext?, @Composable () -&gt; Unit)</code> 함수에서 구현된 ComposeView 인스턴스를 ContentLayout을 widht/height를 wrapContent크기로 정하여 ContentView를 Set해주게 된다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Composes the given composable into the given activity. The [content] will become the root view</span></span><br><span class="line"><span class="comment"> * of the given activity.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This is roughly equivalent to calling [ComponentActivity.setContentView] with a [ComposeView]</span></span><br><span class="line"><span class="comment"> * i.e.:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * ```</span></span><br><span class="line"><span class="comment"> * setContentView(</span></span><br><span class="line"><span class="comment"> *   ComposeView(this).apply &#123;</span></span><br><span class="line"><span class="comment"> *     setContent &#123;</span></span><br><span class="line"><span class="comment"> *       MyComposableContent()</span></span><br><span class="line"><span class="comment"> *     &#125;</span></span><br><span class="line"><span class="comment"> *   &#125;</span></span><br><span class="line"><span class="comment"> * )</span></span><br><span class="line"><span class="comment"> * ```</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parent The parent composition reference to coordinate scheduling of composition updates</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> content A `<span class="doctag">@Composable</span>` function declaring the UI contents</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">fun</span> ComponentActivity.<span class="title">setContent</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">    parent: <span class="type">CompositionContext</span>? = <span class="literal">null</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    content: @<span class="type">Composable</span> () -&gt; <span class="type">Unit</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">  	...</span><br><span class="line">		<span class="keyword">else</span> ComposeView(<span class="keyword">this</span>).apply &#123;</span><br><span class="line">        <span class="comment">// Set content and parent **before** setContentView</span></span><br><span class="line">        <span class="comment">// to have ComposeView create the composition on attach</span></span><br><span class="line">        setParentCompositionContext(parent)</span><br><span class="line">        setContent(content)</span><br><span class="line">        <span class="comment">// Set the view tree owners before setting the content view so that the inflation process</span></span><br><span class="line">        <span class="comment">// and attach listeners will see them already present</span></span><br><span class="line">        setOwners()</span><br><span class="line">        setContentView(<span class="keyword">this</span>, DefaultActivityContentLayoutParams)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-ComposeView"><a href="#13-ComposeView" class="headerlink" title="13. ComposeView"></a>13. ComposeView</h3><p>android.view.View 는 Jetpack Compose UI 콘텐츠를 사용할 수 있도록 해줍니다. setContent 를 사용하면 composable function content 를 뷰에 제공할 수 있다.</p>
<p>Compose 의 계층 구조는 아래와 같으며. ComposeView 를 통해 androidx.compose.materia 에 정의된 다양한 컴포넌트를 조합하여 Composable function 콘텐츠를 구성할 수 있다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kotlin.Any</span><br><span class="line"> ↳ android.view.View</span><br><span class="line">   ↳ android.view.ViewGroup</span><br><span class="line">     ↳ androidx.compose.ui.platform.AbstractComposeView</span><br><span class="line">       ↳ androidx.compose.ui.platform.ComposeView</span><br></pre></td></tr></table></figure>

<h3 id="14-Compose-Compiler-Compose-Runtime"><a href="#14-Compose-Compiler-Compose-Runtime" class="headerlink" title="14. Compose Compiler / Compose Runtime"></a>14. Compose Compiler / Compose Runtime</h3><p>Compose Compiler 는 <code>@Composable</code> 이 설정된 경우 Composable function 으로 코드 변환과 코틀린 컴파일러 플러그인과 함께 최적화를 활성화한다.</p>
<p>Compose Runtime은 Compose의 프로그래밍 모델과 상태 관리, 그리고 Compose 컴파일러를 지정하기 위한 코어 런타임에 대한 기본 설정을 수행한다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Composable</span><br><span class="line">fun Greeting(name: String) &#123;</span><br><span class="line">    var greet by remember &#123; mutableStateOf(&quot;Hello $name&quot;) &#125;</span><br><span class="line">    Text(text = greet, color = Color.Red)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>위의 코드는 Compose Compiler에 의해 <code>@Composeable</code>은 아래와 같이 변경된다.</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">fun</span> <span class="title">Greeting</span><span class="params">(</span></span></span><br><span class="line"><span class="params"><span class="function">  $composer: <span class="type">Composer</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">  $static: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">  name: <span class="type">String</span></span></span></span><br><span class="line"><span class="params"><span class="function">)</span></span> &#123;</span><br><span class="line">  $composer.start(<span class="number">123</span>)</span><br><span class="line">  <span class="keyword">var</span> greet <span class="keyword">by</span> remember &#123; mutableStateOf(<span class="string">&quot;Hello <span class="variable">$name</span>&quot;</span>) &#125;</span><br><span class="line">  Text(text = greet, color = Color.Red)</span><br><span class="line">  $composer.end()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Compose 는 <code>composer.start</code> 에서 고유의 키를 가지고 있고, 이는 Compose 의 state 가 변경될 때 해당 키를 가진 Compose 만 변경되도록 동작한다.</p>
<p>static 은 상태(state)의 변경여부를 알 수 있는데 상태의 변화가 없는 경우, <code>composer.start</code> 와 <code>composer.end</code> 사이의 UI 의 변경을 하지 않는다.</p>
<p>이때 데이터의 상태가 변경되어 UI 를 다시 구성하는 경우는 Recomposition 이라고 한다.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Jetpack Compose Part 1 - Compose 소개 및 코드랩 따라하기</p><p><a href="https://androiddeepdive.github.io/2021/04/07/2021-04-07 Jetpack Compose Part 1/">https://androiddeepdive.github.io/2021/04/07/2021-04-07 Jetpack Compose Part 1/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Android Deep Dive</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-04-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-07-25</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/Team-Blog/tags/Android/">Android</a><a class="link-muted mr-2" rel="tag" href="/Team-Blog/tags/Jetpack/">Jetpack</a><a class="link-muted mr-2" rel="tag" href="/Team-Blog/tags/Compose/">Compose</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">이 글이 마음에 드시나요? 다음을 통해 후원하실 수 있습니다: </h3><div class="buttons is-centered"><a class="button donate" href="/Team-Blog/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/Team-Blog/" alt="Alipay"></span></a><a class="button donate" href="/Team-Blog/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>커피 한 잔 사주기</span></a><a class="button donate" href="/Team-Blog/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/Team-Blog/" alt="Wechat"></span></a></div></div></div><div class="card"><div class="card-content"><h3 class="title is-5">댓글</h3><div class="notification is-danger">You forgot to set the <code>shortname</code> for Disqus. Please set it in <code>_config.yml</code>.</div></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/Team-Blog/img/avatar.png" alt="ADD"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">ADD</p><p class="is-size-6 is-block">Android Deep Dive</p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">포스트</p><a href="/Team-Blog/archives"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">카테고리</p><a href="/Team-Blog/categories"><p class="title">1</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">태그</p><a href="/Team-Blog/tags"><p class="title">3</p></a></div></div></nav></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">링크</h3><ul class="menu-list"><li><a class="level is-mobile" href="http://github.com/AndroidDeepDive/Study" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Study</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li><li><a class="level is-mobile" href="https://github.com/AndroidDeepDive/Contact-Us" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Contact-Us</span></span><span class="level-right"><span class="level-item tag">github.com</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">카테고리</h3><ul class="menu-list"><li><a class="level is-mobile" href="/Team-Blog/categories/Jetpack-Compose/"><span class="level-start"><span class="level-item">Jetpack Compose</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">최근 글</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-04-06T16:00:00.000Z">2021-04-07</time></p><p class="title"><a href="/Team-Blog/2021/04/07/2021-04-07%20Jetpack%20Compose%20Part%201/">Jetpack Compose Part 1 - Compose 소개 및 코드랩 따라하기</a></p><p class="categories"><a href="/Team-Blog/categories/Jetpack-Compose/">Jetpack Compose</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">아카이브</h3><ul class="menu-list"><li><a class="level is-mobile" href="/Team-Blog/archives/2021/04/"><span class="level-start"><span class="level-item">4월 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">태그</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/Team-Blog/tags/Android/"><span class="tag">Android</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Team-Blog/tags/Compose/"><span class="tag">Compose</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/Team-Blog/tags/Jetpack/"><span class="tag">Jetpack</span><span class="tag">1</span></a></div></div></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><!--!--></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/Team-Blog/"><img src="/Team-Blog/img/logo.png" alt="Android Deep Dive" height="28"></a><p class="is-size-7"><span>&copy; 2021 Android Deep Dive</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("ko");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/Team-Blog/js/column.js"></script><a id="back-to-top" title="맨 위로" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/Team-Blog/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "이 웹 사이트는 귀하의 경험을 향상시키기 위해 Cookie를 사용합니다.",
          dismiss: "무시",
          allow: "허용",
          deny: "거부",
          link: "더 알아보기",
          policy: "Cookie 정책",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/Team-Blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="입력 하세요..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/Team-Blog/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/Team-Blog/content.json"}, {"hint":"입력 하세요...","untitled":"(제목 없음)","posts":"포스트","pages":"페이지","categories":"카테고리","tags":"태그"});
        });</script></body></html>